name: r2dock
author: Téo Haÿs <teo.hays@inria.fr>
about: "Deploys Docker containers using Rhubarbe. \nPlease create issues and read the wiki here : \nhttps://github.com/haysberg/r2dock"
settings :
    - ArgRequiredElseHelp
    - InferSubcommands
    - DeriveDisplayOrder
    - DontCollapseArgsInUsage
subcommands:
    - deploy:
        settings:
            - AllowLeadingHyphen
            - TrailingVarArg
        about: deploys the selected container on nodes
        usage: r2dock deploy [FLAGS] [OPTIONS] [--nodes "<nodes>"] --image <image> [--command <command>]
        args:
            - image:
                short: i
                long: image
                value_name: image
                takes_value: true
                required: true
                help: the image to deploy, <repository>/image:tag format
            - options:
                short: o
                long: options
                takes_value: true
                multiple: true
                help: the options string that you want to send to the container.
            - nodes:
                short: n
                long: nodes
                takes_value: true
                help: nodes you want to deploy the container on
            - bypass-check:
                short: B
                long: bypass-check
                help: bypass the check to see if the nodes are running the required Docker-ready image
            - bootstrap:
                long: bootstrap
                help: deploys the latest r2dock compatible image on the machine before deploying the container
                short: b
                conflicts_with: ndz
            - ndz:
                long: ndz
                help: choose a .ndz image to be deployed before the container
                conflicts_with: bootstrap
                takes_value: true
            - command:
                long: command
                help: Use this option to choose what command to pass to the container. ALWAYS USE LAST.
                takes_value: true
                multiple: true

    - destroy:
        about: destroys containers or images PERMANENTLY
        args:
            - yes:
                short: y
                long: yes
                help: doesn't ask if you really want to destroy the container
            - image:
                short: i
                long: image
                value_name: image
                takes_value: true
                help: the image to destroy PERMANENTLY
            - nodes:
                short: n
                long: nodes
                takes_value: true
                help: nodes you want to destroy
    - list:
        about: lists the CUSTOM images to deploy. Images on Dockerhub are NOT listed
        args:
            - details:
                long: details
                short: d
                takes_value: true
                help: name of the image for which you want to display all the different versions available
    - save:
        about: saves the selected container as an image for future use
        args: 
            - name:
                long: name
                takes_value: true
                required: true
                help: name of the image you wish to create
            - node: 
                long: node
                short: n
                takes_value: true
                required: true
                help: identifier of the node you want to save